"use strict";var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e);function r(e){if(!e)return[];const t=[];return Array.from(e.childNodes).forEach((e=>{var n;3===e.nodeType?t.push((null===(n=e.textContent)||void 0===n?void 0:n.trim())||""):t.push(...r(e))})),t}const l=(e,t="")=>e?r(e).join("\n"):t,o=e=>e.replace(/\s+$/,"");module.exports=t=>{var{children:r,ellipsis:u="...",lines:i=1,trimWhitespace:c=!1,onTruncate:s,width:a}=t,f=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(r=Object.getOwnPropertySymbols(e);l<r.length;l++)t.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(e,r[l])&&(n[r[l]]=e[r[l]])}return n}(t,["children","ellipsis","lines","trimWhitespace","onTruncate","width"]);const d=e.useRef(null),p=e.useRef(null),h=e.useRef(null),m=e.useRef(null),v=e.useRef(null),[y,b]=function(e){const t=n.default.useRef(null),[r,l]=n.default.useState(e);n.default.useEffect((()=>{t.current&&(t.current(r),t.current=null)}),[r]);const o=n.default.useCallback(((e,n)=>(t.current=n||null,l(e))),[]);return[r,o]}(0);e.useEffect((()=>{const e=document.createElement("canvas");v.current=e.getContext("2d");const t=h.current;return()=>{var e;m.current&&cancelAnimationFrame(m.current),t&&(null===(e=t.parentNode)||void 0===e||e.removeChild(t))}}),[]);const w=e.useCallback((e=>{var t;if(!d.current)return;let n=a;if(n||(n=d.current.parentNode instanceof HTMLElement?Math.floor(null===(t=d.current.parentNode)||void 0===t?void 0:t.getBoundingClientRect().width):0),!n)return window.requestAnimationFrame((()=>w(e)));const r=window.getComputedStyle(d.current),l=[r.fontWeight,r.fontStyle,r.fontSize,r.fontFamily].join(" ");v.current&&(v.current.font=l),b(n,e)}),[b,a]);e.useEffect((()=>{const e=()=>{w()};return w((()=>{var e;p.current&&(null===(e=p.current.parentNode)||void 0===e||e.removeChild(p.current))})),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[a,w]);const g=e.useCallback((e=>{"function"==typeof s&&(m.current=window.requestAnimationFrame((()=>{s(e)})))}),[s]),E=e.useCallback(((e,t,r)=>{if(t===r.length-1)return n.default.createElement("span",{key:t},e,t===i-1&&u);{const r=n.default.createElement("br",{key:t+"br"});return e?[n.default.createElement("span",{key:t},e),r]:r}}),[u,i]),j=e=>{var t;return(null===(t=v.current)||void 0===t?void 0:t.measureText(e).width)||0},C=e.useMemo((()=>{if(!!(!d.current||!y))return null;return i>0?(()=>{var e;const t=[],n=l(p.current).split("\n").map((e=>e.split(" ")));let r=!0;const u=(null===(e=h.current)||void 0===e?void 0:e.offsetWidth)||0;for(let e=1;e<=i;e++){const l=n[0];if(0===l.length){t.push(),n.shift(),e--;continue}let s=l.join(" ");if(j(s)<=y&&1===n.length){r=!1,t.push(s);break}if(e===i){const e=l.join(" ");let n=0,r=e.length-1;for(;n<=r;){const t=Math.floor((n+r)/2),l=e.slice(0,t+1);j(l)+u<=y?n=t+1:r=t-1}let i=e.slice(0,n);if(c)for(i=o(i);!i.length&&t.length;){const e=t.pop();i=o(e||"")}t.push(i)}else{let r=0,o=l.length-1;for(;r<=o;){const e=Math.floor((r+o)/2),t=l.slice(0,e+1).join(" ");j(t)<=y?r=e+1:o=e-1}if(0===r){e=i-1;continue}s=l.slice(0,r).join(" "),n[0].splice(0,r),t.push(s)}}return g(r),t})().map(E):r}),[r,g,i,E,y,c]);return n.default.createElement("span",Object.assign({},f),n.default.createElement("span",{ref:d},C),n.default.createElement("span",{ref:p},r),n.default.createElement("span",{ref:h,style:{position:"fixed",visibility:"hidden",top:0,left:0}},u))};
//# sourceMappingURL=index.js.map
